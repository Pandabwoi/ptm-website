<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: 'Segoe UI', sans-serif; background: #0f0f0f; color: #fff; padding: 20px; }
      select, input { padding: 10px; margin: 10px 0; width: 100%; font-size: 16px; }
      button { padding: 10px 20px; background: #00c9ff; border: none; font-weight: bold; cursor: pointer; color: black; }
    </style>
  </head>
  <body>
    <h2>PTM TOKEN MATRIX</h2>

    <label for="grade">Select Grade:</label>
    <select id="grade">
      <option value="">--Select Grade--</option>
      ${[...Array(12)].map((_, i) => `<option value="${i+1}">Grade ${i+1}</option>`).join('')}
    </select>

    <label for="section">Select Section:</label>
    <select id="section">
      <option value="">--Select Section--</option>
      ${["A", "B", "C", "D", "E", "F"].map(s => `<option value="${s}">${s}</option>`).join('')}
    </select>

    <label for="name">Student Name:</label>
    <input type="text" id="name" placeholder="Enter student name" />

    <button onclick="submit()">Generate Token</button>
    <button onclick="reset()" style="background:#ff4d4d; margin-left:10px;">Reset All Tokens</button>

    <p id="msg"></p>

    <script>
      function submit() {
        const data = {
          grade: document.getElementById("grade").value,
          section: document.getElementById("section").value,
          name: document.getElementById("name").value
        };
        document.getElementById("msg").innerText = "Processing...";
        google.script.run.withSuccessHandler(function(response) {
          document.getElementById("msg").innerText = response;
        }).submitData(data);
      }

      function reset() {
        if (confirm("Are you sure you want to reset all tokens?")) {
          google.script.run.withSuccessHandler(function(msg) {
            document.getElementById("msg").innerText = msg;
          }).resetTokens();
        }
      }
    </script>
  </body>
</html>